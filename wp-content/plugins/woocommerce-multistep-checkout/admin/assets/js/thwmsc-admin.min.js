function thwepoSetupEnhancedMultiSelectWithValue(elm){thwepo_base.setupEnhancedMultiSelectWithValue(elm)}function thwepoSetupSortableTable(parent,elm,left){thwepo_base.setupSortableTable(parent,elm,left)}function thwepoSetupPopupTabs(parent,elm,left){thwepo_base.setupPopupTabs(parent,elm,left)}function thwepoOpenFormTab(elm,tab_id,form_type){thwepo_base.openFormTab(elm,tab_id,form_type)}function thwmscOpenNewStepForm(){thwmsc_settings.openNewStepForm()}function thwmscButtonStyleListner(checkbox_button){thwmsc_settings.buttonStyleListner(checkbox_button)}function thwmscverticalStyle(layout){thwmsc_settings.verticalStyle(layout)}function thwmscRemoveStep(elm,step_name){thwmsc_settings.removeStep(elm,step_name)}function thwmscEditStepForm(elm,rowId){thwmsc_settings.openEditSectionForm(elm,rowId)}function thwmscRemoveImage(elm){thwmsc_settings.removeUploadedImage(elm)}function thwmscEnableBg(elm){thwmsc_settings.enableBackground(elm)}function thwmscEnableCustomContent(elm){thwmsc_settings.enableCustomContent(elm)}function thwmscPassedbgEnable(elm){thwmsc_settings.passedbgEnable(elm)}function thwmscShowLogin(elm){thwmsc_settings.ShowLogin(elm)}function thwmscShowCoupon(elm){thwmsc_settings.ShowCoupon(elm)}function thwmscMyaccountChange(elm){thwmsc_settings.MyaccountChange(elm)}var thwmsc_settings_advanced=function($,window,document){$(function(){var advanced_settings_form=$("#thwmsc_advanced_settings_form");advanced_settings_form[0]&&thwmsc_base.setupEnhancedMultiSelectWithValue(advanced_settings_form)})}(window.jQuery,window,document),thwmsc_base=function($,window,document){"use strict";function escapeHTML(html){var fn=function(tag){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;"}[tag]||tag};return html.replace(/[&<>"]/g,fn)}function decodeHtml(str){if(str&&"string"==typeof str){var map={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return str.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(m){return map[m]})}return str}function isHtmlIdValid(id){return/^[a-z\_]+[a-z0-9\_]*$/.test(id.trim())}function isValidHexColor(value){return!!preg_match("/^#[a-f0-9]{6}$/i",value)}function setup_tiptip_tooltips(){var tiptip_args={attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200};$(".tips").tipTip(tiptip_args)}function setup_enhanced_multi_select(parent){parent.find("select.thpladmin-enhanced-multi-select").each(function(){$(this).hasClass("enhanced")||$(this).select2({minimumResultsForSearch:10,allowClear:!0,placeholder:$(this).data("placeholder")}).addClass("enhanced")})}function setup_enhanced_multi_select_with_value(parent){var layout=parent.find('input[name="i_thwmsc_layout"]:checked').val();"thwmsc_vertical_box"!=layout&&"thwmsc_vertical_arrow"!=layout||$('select[name="i_tab_align"] option[value="center"]').hide(),parent.find("select.thpladmin-enhanced-multi-select").each(function(){if(!$(this).hasClass("enhanced")){$(this).select2({minimumResultsForSearch:10,allowClear:!0,placeholder:$(this).data("placeholder")}).addClass("enhanced");var value=$(this).data("value");value=value.split(","),$(this).val(value),$(this).trigger("change")}})}function setup_color_picker(form){form.find(".thpladmin-colorpick").iris({change:function(event,ui){$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:ui.color.toString()})},hide:!0,border:!0}).click(function(){$(".iris-picker").hide(),$(this).closest("td").find(".iris-picker").show()}),$("body").click(function(){$(".iris-picker").hide()}),$(".thpladmin-colorpick").click(function(event){event.stopPropagation()}),$(".thpladmin-colorpick").each(function(){var value=$(this).val();$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:value})})}function setup_color_pick_preview(form){form.find(".thpladmin-colorpick").each(function(){$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:this.value})})}function setup_popup_tabs(form,selector_prefix){$("."+selector_prefix+"-tabs-menu a").click(function(event){event.preventDefault(),$(this).parent().addClass("current"),$(this).parent().siblings().removeClass("current");var tab=$(this).attr("href");$("."+selector_prefix+"-tab-content").not(tab).css("display","none"),$(tab).fadeIn()})}function open_form_tab(elm,tab_id,form_type){var tabs_container=$("#thwepo-tabs-container_"+form_type);$(elm).parent().addClass("current"),$(elm).parent().siblings().removeClass("current");var tab=$("#"+tab_id+"_"+form_type);tabs_container.find(".thpladmin-tab-content").not(tab).css("display","none"),$(tab).fadeIn()}function prepare_field_order_indexes(elm){$(elm+" tbody tr").each(function(index,el){$("input.f_order",el).val(parseInt($(el).index(elm+" tbody tr")))})}function setup_sortable_table(parent,elm,left){parent.find(elm+" tbody").sortable({items:"tr:not(.static)",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(e,ui){return ui.children().each(function(){$(this).width($(this).width())}),ui.css("left",left),ui}}),$(elm+" tbody").on("sortstart",function(event,ui){ui.item.css("background-color","#f6f6f6")}),$(elm+" tbody").on("sortstop",function(event,ui){ui.item.removeAttr("style"),prepare_field_order_indexes(elm)})}function get_property_field_value(form,type,name){var value="";switch(type){case"select":value=form.find("select[name=i_"+name+"]").val(),value=null==value?"":value;break;case"checkbox":value=form.find("input[name=i_"+name+"]").prop("checked"),value=value?1:0;break;default:value=form.find("input[name=i_"+name+"]").val(),value=null==value?"":value}return value}function set_property_field_value(form,type,name,value,multiple){switch(type){case"select":1==multiple&&"string"==typeof value&&(value=value.split(","),name+="[]"),form.find('select[name="i_'+name+'"]').val(value);break;case"checkbox":value=1==value,form.find("input[name=i_"+name+"]").prop("checked",value);break;case"radio":form.find("input[name=i_"+name+"][value="+value+"]").prop("checked",!0);case"colorpicker":form.find("input[name=i_"+name+"]").val(value),form.find("."+name+"_preview").css("backgroundColor",value);case"textarea":value=value?decodeHtml(value):value,form.find("textarea[name=i_"+name+"]").html(value);default:value=value?decodeHtml(value):value,form.find("input[name=i_"+name+"]").val(value)}}return{escapeHTML:escapeHTML,isHtmlIdValid:isHtmlIdValid,isValidHexColor:isValidHexColor,setup_tiptip_tooltips:setup_tiptip_tooltips,setupEnhancedMultiSelect:setup_enhanced_multi_select,setupEnhancedMultiSelectWithValue:setup_enhanced_multi_select_with_value,setupColorPicker:setup_color_picker,setup_color_pick_preview:setup_color_pick_preview,setupSortableTable:setup_sortable_table,setupPopupTabs:setup_popup_tabs,openFormTab:open_form_tab,get_property_field_value:get_property_field_value,set_property_field_value:set_property_field_value}}(window.jQuery,window,document),thwmsc_settings=function($,window,document){"use strict";function set_default_layout_values(form){var form=$("#thwmsc_advanced_settings_form");$.each(TIME_LINE_VALUES,function(name,field){var type=field.type,value=field.value;thwmsc_base.set_property_field_value(form,type,name,value,"")})}function upload_icon_image(form){var mediaUploader;if(mediaUploader)return void mediaUploader.open();mediaUploader=wp.media.frames.file_frame=wp.media({title:"Choose Image",button:{text:"Choose Image"},library:{type:"image"},multiple:!1}),mediaUploader.on("select",function(){var attachment=mediaUploader.state().get("selection").first().toJSON();console.log(attachment),form.find("#i_index_media_img").attr("src",attachment.url),form.find("#i_index_media").val(attachment.id),form.find("#i_index_media_url").val(attachment.id),form.find(".icon_preview").css("display","inline-block"),form.find(".thwmsc_remove_uploaded").show()}),mediaUploader.open()}function _openEditSectionForm(elm,rowId){var row=$(elm).closest("tr"),popup=$("#thwmsc_edit_step_form_pp"),form=$("#thwmsc_step_form_edit");clear_step_form(form);var my_account=row.find(".myaccount_form").val(),name=row.find(".s_name").val(),props_json=row.find(".s_props").val(),props=JSON.parse(props_json),logged_in=form.find(".logged_index");populate_field_form(form,row,props,rowId),show_hide_field_using_wmsc_blur(form.find(".enable-bg"),$(".content-bg"));var is_custom=form.find("input[name='i_custom']").val();is_custom=parseInt(is_custom);var custom_content_row=$(".custom-content");if(is_custom){show_hide_field_using_wmsc_blur(form.find(".enable-custom"),custom_content_row),form.find(".custom-cnt-position").hide(),form.find(".custom-content .thpladmin_tooltip").hide()}else form.find(".custom-cnt-position").show(),form.find(".custom-content .thpladmin_tooltip").show(),remove_class_wmsc_blur(custom_content_row);"login"!=name||my_account?logged_in.removeClass("login_edit"):logged_in.addClass("login_edit"),"order_review"==name?form.find(".enable-row").hide():form.find(".enable-row").show(),default_steps.indexOf(name)>-1?$(".wmsc-independent").addClass("wmsc-hide-independant"):$(".wmsc-independent").removeClass("wmsc-hide-independant"),popup.dialog("open"),popup.find(".thwmsc_tab_general_link").click()}function _removeUploadedImage(elm){var form=elm.closest("form");$(form).find("#i_index_media_img").attr("src",""),$(form).find("#i_index_media").val(""),$(form).find(".icon_preview").hide(),$(form).find(".thwmsc_remove_uploaded").hide()}function _enableBackground(elm){var form=elm.closest("form"),content_bg=$(form).find(".content-bg");elm.checked?content_bg.removeClass("wmsc-blur"):content_bg.addClass("wmsc-blur")}function _enableCustomContent(elm){var form=elm.closest("form"),host_class=$(form).find(".custom-content");show_hide_field_using_wmsc_blur($(elm),host_class)}function _show_login_form_settings(elm){var form=elm.closest("form"),host_class=$(form).find(".th-show-login-settings"),myaccount_form=$(form).find("#a_fuse_my_account_login");host_class.each(function(){$(this).is("#th-show-login-form")?1!=myaccount_form.prop("checked")&&show_hide_field_using_wmsc_blur($(elm),$(this)):show_hide_field_using_wmsc_blur($(elm),$(this))})}function _show_coupon_form_settings(elm){var form=elm.closest("form"),host_class=$(form).find("#th-show-coupon-form");show_hide_field_using_wmsc_blur($(elm),host_class)}function _myaccount_change_settings(elm){var form=elm.closest("form"),host_class=$(form).find("#th-show-login-form");hide_field_using_wmsc_blur($(elm),host_class)}function hide_field_using_wmsc_blur(elm,host_class){1!=elm.prop("checked")?remove_class_wmsc_blur(host_class):add_class_wmsc_blur(host_class)}function show_hide_field_using_wmsc_blur(elm,host_class){1==elm.prop("checked")?remove_class_wmsc_blur(host_class):add_class_wmsc_blur(host_class)}function add_class_wmsc_blur(host_class){host_class.addClass("wmsc-blur")}function remove_class_wmsc_blur(host_class){host_class.removeClass("wmsc-blur")}function populate_field_form(form,row,props,rowId){$.each(STEP_FORM_FIELDS,function(name,field){var type=field.type,value=props[name];"name"==name&&form.find("input[name=i_name]").prop("readonly",!0),"order_review"==props.name&&"enabled"==name?form.find("input[name=i_enabled]").prop("disabled",!0):form.find("input[name=i_enabled]").prop("disabled",!1),"radio"==type?($("input[name='i_"+name+"'][value='"+value+"']").prop("checked",!0),(value="icon_index")&&(form.find("#i_index_media_img").attr("src",props.img_url),props.img_url&&(form.find(".icon_preview").css("display","inline-block"),form.find(".thwmsc_remove_uploaded").show()))):thwmsc_base.set_property_field_value(form,type,name,value,field.multiple),"select"==type&&(name=1==field.multiple?name+"[]":name,1!=field.multiple&&1!=field.change||form.find('select[name="i_'+name+'"]').trigger("change"))})}function clear_step_form(form){form.find(".err_msgs").html(""),$.each(STEP_FORM_FIELDS,function(fname,field){var ftype=field.type,fvalue=field.value;"radio"!=ftype&&thwmsc_base.set_property_field_value(form,ftype,fname,fvalue,0)})}function validate_step_form(form){var name=form.find("input[name=i_name]").val(),action=form.find("input[name=s_action]").val(),err_msgs="";return""==name.trim()?err_msgs="Name is required":thwmsc_base.isHtmlIdValid(name)||(err_msgs=MSG_INVALID_NAME),reserved_steps.indexOf(name)>-1&&""==err_msgs&&"new"==action&&(err_msgs="Step Name is a reserved step"),""==err_msgs||(form.find(".err_msgs").html(err_msgs),!1)}function display_index_field(index_value){"text_index"==index_value?($(".text_index").show(),$(".icon_index").hide()):($(".text_index").hide(),$(".icon_index").show())}var MSG_INVALID_NAME='NAME must begin with a lowercase letter ([a-z]) and may be followed by any number of lowercase letters, digits ([0-9]) and underscores ("_")',STEP_FORM_FIELDS=(thwmsc_var.admin_path,{name:{name:"name",label:"Name",type:"text",required:1},title:{name:"title",label:"Step Title",type:"text",required:1},index:{name:"index",label:"Display Order",type:"text"},indextype:{name:"indextype",label:"Display Order",type:"radio",value:"text_index"},index_media:{name:"index_media",type:"hidden"},media_url:{name:"media_url",type:"hidden"},order:{name:"order",type:"hidden"},custom:{name:"custom",type:"hidden",value:1},action:{name:"action",type:"hidden",value:""},action_before:{name:"action_before",type:"hidden",value:""},action_after:{name:"action_after",type:"hidden",value:""},enabled:{name:"enabled",label:"Enabled",type:"checkbox",value:1,checked:!0},enable_step_bg:{name:"enable_step_bg",label:"Enable Step Background",type:"checkbox",value:0},step_bg:{name:"step_bg",label:"Step Content Background",type:"colorpicker"},step_font:{name:"step_font",label:"Step Content Color",type:"colorpicker"},step_independent:{name:"step_independent",label:"Independent of WCFE",type:"checkbox",value:0},step_content:{name:"step_content",label:"Step Content",type:"textarea",value:""},index_logged_in:{name:"index_logged_in",label:"Logged in Index",type:"text",value:""},custom_position:{name:"custom_position",label:"Display Position",type:"select",value:"above_fields"}}),TIME_LINE_VALUES={step_text_color_active:{name:"step_text_color_active",label:"Step text color - Active",type:"colorpicker",value:"#050505"}},reserved_steps=["cart","login","coupon","review_order"],default_steps=["cart","login","coupon","billing","shipping","review_order","order_review"];$(function(){var general_settings_form=$("#thwmsc_tab_general_settings_form"),form=$("#thwmsc_advanced_settings_form");thwmsc_base.setupColorPicker(form),$("#thwmsc_new_step_form_pp").dialog({modal:!0,width:500,resizable:!1,autoOpen:!1,dialogClass:"thwmsc-form-pp",open:function(event,ui){var new_step_form=$("#thwmsc_new_step_form");thwmsc_base.setupColorPicker(new_step_form)},buttons:[{text:"Cancel",click:function(){$(this).dialog("close")}},{text:"Save",click:function(){var form=$("#thwmsc_new_step_form");validate_step_form(form)&&form.submit()}}]}),$("#thwmsc_edit_step_form_pp").dialog({modal:!0,width:500,resizable:!1,autoOpen:!1,dialogClass:"thwmsc-form-pp",open:function(event,ui){display_index_field($(".thpladmin_checkbox input[type='radio']:checked").val());var edit_step_form=$("#thwmsc_edit_step_form_pp");thwmsc_base.setupColorPicker(edit_step_form)},buttons:[{text:"Cancel",click:function(){$(this).dialog("close")}},{text:"Update",click:function(){var form=$("#thwmsc_step_form_edit");validate_step_form(form)&&form.submit()}}]}),thwmsc_base.setupSortableTable(general_settings_form,"#thwmsc_checkout_steps","0"),thwmsc_base.setup_tiptip_tooltips(),$(".thpladmin_checkbox input[type='radio']").change(function(){display_index_field($(this).val())}),$(".index_icon_upload").click(function(e){e.preventDefault(),upload_icon_image($(this).closest("form"))}),$(".th-login-raw .loggedin-index").prop("readonly",!0),$("select[name='i_placeholder_step']").change(function(){var selected_text=$(this).find("option:selected").text();$(".thpladmin-enhanced-multi-select option:contains("+selected_text+")").detach();for(var steps_for_review=thwmsc_var.steps_for_review,review_steps_arr=JSON.parse(steps_for_review),count=Object.keys(review_steps_arr).length,keys=Object.keys(review_steps_arr),text=Object.values(review_steps_arr),new_option="",i=0;i<count;i++){var data=(keys[i],{id:keys[i],text:text[i]}),option_exists=$("select.thpladmin-enhanced-multi-select option[value="+data.id+"]").length;data.text!=selected_text&&0==option_exists&&(new_option=new Option(data.text,data.id,!1,!1))}$(".thpladmin-enhanced-multi-select").append(new_option).trigger("change")})});var _openNewStepForm=function(){var form=$("#thwmsc_new_step_form");clear_step_form(form),display_index_field($(".thpladmin_checkbox input[type='radio']:checked").val()),1==form.find(".enable-custom").prop("checked")?$(".custom-content").removeClass("wmsc-blur"):$(".custom-content").addClass("wmsc-blur"),$("#thwmsc_new_step_form_pp").dialog("open")},_buttonStyleListner=function(checkbox_button){var button_style=$("#thwmsc_button_styles");checkbox_button.checked?button_style.removeClass("wmsc-blur"):button_style.addClass("wmsc-blur")},_passedbgEnable=function(passed_enable){var passed_tab=$("#passed-tab-settings");passed_enable.checked?passed_tab.removeClass("wmsc-blur"):passed_tab.addClass("wmsc-blur")};return{openNewStepForm:_openNewStepForm,buttonStyleListner:_buttonStyleListner,verticalStyle:function(layout){var layout_value=layout.value,tab_align=$(".tab_align"),vertical_width=$(".vertical_width"),time_line_type=$(".time_line_type"),custom_separator_icon=$(".custom_separator_icon"),tab_format_border=$(".border_tab_format"),dot_style=$(".dot_format_style"),step_style=$(".step_style");"thwmsc_vertical_box"==layout_value||"thwmsc_vertical_arrow"==layout_value?($('select[name="i_tab_align"] option[value="center"]').hide(),$('select[name="i_tab_align"]').val("left"),tab_align.show(),vertical_width.show(),time_line_type.hide(),custom_separator_icon.hide(),tab_format_border.hide(),dot_style.hide(),step_style.show()):"thwmsc_time_line_step"==layout_value?(set_default_layout_values(),tab_align.hide(),vertical_width.hide(),time_line_type.show(),custom_separator_icon.hide(),tab_format_border.hide(),dot_style.hide(),step_style.show()):"thwmsc_accordion_tab"==layout_value?(tab_align.hide(),vertical_width.hide(),time_line_type.hide(),custom_separator_icon.hide(),tab_format_border.hide(),dot_style.hide(),step_style.show()):"thwmsc_custom_separator"==layout_value?(tab_align.show(),$('select[name="i_tab_align"] option[value="center"]').show(),custom_separator_icon.show(),vertical_width.hide(),time_line_type.hide(),tab_format_border.hide(),dot_style.hide(),step_style.show()):"thwmsc_tab_format"==layout_value?(tab_format_border.show(),tab_align.show(),$('select[name="i_tab_align"] option[value="center"]').show(),vertical_width.hide(),time_line_type.hide(),custom_separator_icon.hide(),dot_style.hide(),step_style.show()):"thwmsc_simple_dot_format"==layout_value?(tab_align.show(),$('select[name="i_tab_align"] option[value="center"]').show(),vertical_width.hide(),time_line_type.hide(),custom_separator_icon.hide(),tab_format_border.hide(),dot_style.show(),step_style.hide()):(tab_align.show(),$('select[name="i_tab_align"] option[value="center"]').show(),vertical_width.hide(),time_line_type.hide(),custom_separator_icon.hide(),tab_format_border.hide(),dot_style.hide(),step_style.show())},removeStep:function(elm,step_name){if(confirm("Are you sure you want to delete this step?.")){$(":input[name=step_name]").val(step_name);var form=$(elm).closest("form");form&&form.submit()}},openEditSectionForm:_openEditSectionForm,removeUploadedImage:_removeUploadedImage,enableBackground:_enableBackground,enableCustomContent:_enableCustomContent,passedbgEnable:_passedbgEnable,ShowLogin:_show_login_form_settings,ShowCoupon:_show_coupon_form_settings,MyaccountChange:_myaccount_change_settings}}(window.jQuery,window,document);